"""This is a generated python file."""

from __future__ import unicode_literals

# make pylflakes accept this
# noqa
state_machine = {'events': {'AQ_DIR_DELETE_ERROR': [{'ACTION': 'md.create(path=path, uuid=uuid, type=type) aq.query(uuid=uuid)',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': 'the user deleted something we couldnt delete from the server. Re create.',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'T',
                                                     'not_available': 'F'},
                                      'STATE': {'changed': 'NA',
                                                'has_metadata': 'F',
                                                'is_directory': 'NA'},
                                      'STATE_OUT': {'changed': 'NONE',
                                                    'has_metadata': 'T',
                                                    'is_directory': 'T'}},
                                     {'ACTION': 'md.create(path=path, uuid=uuid, type=type) aq.query(uuid=uuid)',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': 'the user deleted something we couldnt delete from the server. Re create.',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'F',
                                                     'not_available': 'T'},
                                      'STATE': {'changed': 'NA',
                                                'has_metadata': 'F',
                                                'is_directory': 'NA'},
                                      'STATE_OUT': {'changed': 'NONE',
                                                    'has_metadata': 'T',
                                                    'is_directory': 'T'}},
                                     {'ACTION': 'NA',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': '',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'NA',
                                                     'not_available': '*'},
                                      'STATE': {'changed': 'NA',
                                                'has_metadata': 'F',
                                                'is_directory': 'NA'},
                                      'STATE_OUT': {'changed': '*',
                                                    'has_metadata': '*',
                                                    'is_directory': '*'}},
                                     {'ACTION': 'NA',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': '',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': '*',
                                                     'not_available': 'NA'},
                                      'STATE': {'changed': 'NA',
                                                'has_metadata': 'F',
                                                'is_directory': 'NA'},
                                      'STATE_OUT': {'changed': '*',
                                                    'has_metadata': '*',
                                                    'is_directory': '*'}},
                                     {'ACTION': 'NA',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': '',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': '*',
                                                     'not_available': 'NA'},
                                      'STATE': {'changed': '*',
                                                'has_metadata': 'T',
                                                'is_directory': '*'},
                                      'STATE_OUT': {'changed': '*',
                                                    'has_metadata': '*',
                                                    'is_directory': '*'}},
                                     {'ACTION': 'NA',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': '',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'NA',
                                                     'not_available': '*'},
                                      'STATE': {'changed': '*',
                                                'has_metadata': 'T',
                                                'is_directory': '*'},
                                      'STATE_OUT': {'changed': '*',
                                                    'has_metadata': '*',
                                                    'is_directory': '*'}},
                                     {'ACTION': 'CONFLICT, recreate from deleted uuid',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': 'the user deleted something we could not delete from the server and replaced it with stuff. Move user files to conflict and re download stuff from the server',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'F',
                                                     'not_available': 'T'},
                                      'STATE': {'changed': '!SERVER',
                                                'has_metadata': 'T',
                                                'is_directory': '*'},
                                      'STATE_OUT': {'changed': 'NONE',
                                                    'has_metadata': 'T',
                                                    'is_directory': 'T'}},
                                     {'ACTION': 'DESPAIR',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': 'the user deleted something we could not delete from the server and replaced it with stuff. Move user files to conflict and re download stuff from the server',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'F',
                                                     'not_available': 'T'},
                                      'STATE': {'changed': 'SERVER',
                                                'has_metadata': 'T',
                                                'is_directory': '*'},
                                      'STATE_OUT': {'changed': '*',
                                                    'has_metadata': '*',
                                                    'is_directory': '*'}},
                                     {'ACTION': 'CONFLICT',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': 'the user deleted something we could not delete from the server and replaced it with stuff. Move user files to conflict and re download stuff from the server',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'T',
                                                     'not_available': 'F'},
                                      'STATE': {'changed': '*',
                                                'has_metadata': 'T',
                                                'is_directory': '*'},
                                      'STATE_OUT': {'changed': 'NONE',
                                                    'has_metadata': 'T',
                                                    'is_directory': 'T'}},
                                     {'ACTION': 'PANIC',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': '',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'F',
                                                     'not_available': 'F'},
                                      'STATE': {'changed': '*',
                                                'has_metadata': '*',
                                                'is_directory': '*'},
                                      'STATE_OUT': {'changed': 'NONE',
                                                    'has_metadata': 'T',
                                                    'is_directory': 'T'}},
                                     {'ACTION': 'NA',
                                      'ACTION_FUNC': '',
                                      'COMMENTS': '',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'T',
                                                     'not_available': 'T'},
                                      'STATE': {'changed': '*',
                                                'has_metadata': '*',
                                                'is_directory': '*'},
                                      'STATE_OUT': {'changed': '*',
                                                    'has_metadata': '*',
                                                    'is_directory': '*'}}],
            'AQ_DIR_DELETE_OK': [{'ACTION': 'pass',
                                   'ACTION_FUNC': 'nothing',
                                   'COMMENTS': 'vanilla case',
                                   'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                  'hash_eq_server_hash': 'NA',
                                                  'not_authorized': 'NA',
                                                  'not_available': 'NA'},
                                   'STATE': {'changed': 'NA',
                                             'has_metadata': 'F',
                                             'is_directory': 'NA'},
                                   'STATE_OUT': {'changed': '=',
                                                 'has_metadata': '=',
                                                 'is_directory': '='}},
                                  {'ACTION': 'pass',
                                   'ACTION_FUNC': 'nothing',
                                   'COMMENTS': 'we deleted something the user recreated, someone else is taking care of uploading this changes',
                                   'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                  'hash_eq_server_hash': 'NA',
                                                  'not_authorized': 'NA',
                                                  'not_available': 'NA'},
                                   'STATE': {'changed': 'NONE',
                                             'has_metadata': 'T',
                                             'is_directory': 'T'},
                                   'STATE_OUT': {'changed': '=',
                                                 'has_metadata': '=',
                                                 'is_directory': '='}},
                                  {'ACTION': 'pass',
                                   'ACTION_FUNC': 'nothing',
                                   'COMMENTS': 'we deleted something the user recreated, someone else is taking care of uploading this changes',
                                   'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                  'hash_eq_server_hash': 'NA',
                                                  'not_authorized': 'NA',
                                                  'not_available': 'NA'},
                                   'STATE': {'changed': 'LOCAL',
                                             'has_metadata': 'T',
                                             'is_directory': 'T'},
                                   'STATE_OUT': {'changed': '=',
                                                 'has_metadata': '=',
                                                 'is_directory': '='}},
                                  {'ACTION': 'DESPAIR',
                                   'ACTION_FUNC': 'DESPAIR',
                                   'COMMENTS': 'somehow we lost ordering of stuff and we got a new file and changes since we tried to delete this file',
                                   'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                  'hash_eq_server_hash': 'NA',
                                                  'not_authorized': 'NA',
                                                  'not_available': 'NA'},
                                   'STATE': {'changed': 'SERVER',
                                             'has_metadata': 'T',
                                             'is_directory': '*'},
                                   'STATE_OUT': {'changed': '*',
                                                 'has_metadata': '*',
                                                 'is_directory': '*'}},
                                  {'ACTION': 'pass',
                                   'ACTION_FUNC': 'nothing',
                                   'COMMENTS': '',
                                   'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                  'hash_eq_server_hash': 'NA',
                                                  'not_authorized': 'NA',
                                                  'not_available': 'NA'},
                                   'STATE': {'changed': '!SERVER',
                                             'has_metadata': 'T',
                                             'is_directory': 'F'},
                                   'STATE_OUT': {'changed': '=',
                                                 'has_metadata': '=',
                                                 'is_directory': '='}}],
            'AQ_DIR_NEW_ERROR': [{'ACTION': 'pass',
                                   'ACTION_FUNC': 'release_marker_error',
                                   'COMMENTS': '',
                                   'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                  'hash_eq_server_hash': 'NA',
                                                  'not_authorized': '*',
                                                  'not_available': '*'},
                                   'STATE': {'changed': '*',
                                             'has_metadata': 'F',
                                             'is_directory': '*'},
                                   'STATE_OUT': {'changed': '=',
                                                 'has_metadata': '=',
                                                 'is_directory': '='}},
                                  {'ACTION': 'CONFLICT',
                                   'ACTION_FUNC': 'filedir_error_in_creation',
                                   'COMMENTS': '',
                                   'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                  'hash_eq_server_hash': 'NA',
                                                  'not_authorized': '*',
                                                  'not_available': '*'},
                                   'STATE': {'changed': '*',
                                             'has_metadata': '*',
                                             'is_directory': 'T'},
                                   'STATE_OUT': {'changed': 'NA',
                                                 'has_metadata': 'F',
                                                 'is_directory': 'NA'}},
                                  {'ACTION': 'pass',
                                   'ACTION_FUNC': 'release_marker_error',
                                   'COMMENTS': '',
                                   'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                  'hash_eq_server_hash': 'NA',
                                                  'not_authorized': '*',
                                                  'not_available': '*'},
                                   'STATE': {'changed': '*',
                                             'has_metadata': '*',
                                             'is_directory': 'F'},
                                   'STATE_OUT': {'changed': '=',
                                                 'has_metadata': '=',
                                                 'is_directory': '='}}],
            'AQ_DIR_NEW_OK': [{'ACTION': 'aq.uuid_map.set(marker, new_id)',
                                'ACTION_FUNC': 'release_marker_ok',
                                'COMMENTS': "it's a file now",
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': '*',
                                          'has_metadata': 'T',
                                          'is_directory': 'F'},
                                'STATE_OUT': {'changed': '=',
                                              'has_metadata': '=',
                                              'is_directory': '='}},
                               {'ACTION': 'aq.uuid_map.set(marker, new_id)',
                                'ACTION_FUNC': 'release_marker_ok',
                                'COMMENTS': 'the dir was now gone',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NA',
                                          'has_metadata': 'F',
                                          'is_directory': 'NA'},
                                'STATE_OUT': {'changed': '=',
                                              'has_metadata': '=',
                                              'is_directory': '='}},
                               {'ACTION': 'md.set(mdid, server_uuid=server_uuid)\nPANIC',
                                'ACTION_FUNC': 'DESPAIR',
                                'COMMENTS': '',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'SERVER',
                                          'has_metadata': 'T',
                                          'is_directory': 'T'},
                                'STATE_OUT': {'changed': 'NONE',
                                              'has_metadata': 'T',
                                              'is_directory': '='}},
                               {'ACTION': 'md.set(mdid, server_uuid=server_uuid)\nRESCAN',
                                'ACTION_FUNC': 'new_local_dir_created',
                                'COMMENTS': '',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NONE',
                                          'has_metadata': 'T',
                                          'is_directory': 'T'},
                                'STATE_OUT': {'changed': '=',
                                              'has_metadata': '=',
                                              'is_directory': '='}}],
            'AQ_DOWNLOAD_DOES_NOT_EXIST': [{'ACTION': '',
                                             'ACTION_FUNC': 'delete_file',
                                             'COMMENTS': "Directory doesn't exist anymore, remove it",
                                             'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                            'hash_eq_server_hash': 'NA',
                                                            'not_authorized': 'NA',
                                                            'not_available': 'NA'},
                                             'STATE': {'changed': '*',
                                                       'has_metadata': 'T',
                                                       'is_directory': 'T'},
                                             'STATE_OUT': {'changed': 'NA',
                                                           'has_metadata': 'F',
                                                           'is_directory': 'NA'}},
                                            {'ACTION': '',
                                             'ACTION_FUNC': 'delete_file',
                                             'COMMENTS': "File doesn't exist anymore, remove it",
                                             'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                            'hash_eq_server_hash': 'NA',
                                                            'not_authorized': 'NA',
                                                            'not_available': 'NA'},
                                             'STATE': {'changed': '!LOCAL',
                                                       'has_metadata': 'T',
                                                       'is_directory': 'F'},
                                             'STATE_OUT': {'changed': 'NA',
                                                           'has_metadata': 'F',
                                                           'is_directory': 'NA'}},
                                            {'ACTION': '',
                                             'ACTION_FUNC': 'conflict_and_delete',
                                             'COMMENTS': "File doesn't exist on server, but has local changes",
                                             'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                            'hash_eq_server_hash': 'NA',
                                                            'not_authorized': 'NA',
                                                            'not_available': 'NA'},
                                             'STATE': {'changed': 'LOCAL',
                                                       'has_metadata': 'T',
                                                       'is_directory': 'F'},
                                             'STATE_OUT': {'changed': 'NA',
                                                           'has_metadata': 'F',
                                                           'is_directory': 'NA'}},
                                            {'ACTION': 'pass',
                                             'ACTION_FUNC': 'nothing',
                                             'COMMENTS': '',
                                             'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                            'hash_eq_server_hash': 'NA',
                                                            'not_authorized': 'NA',
                                                            'not_available': 'NA'},
                                             'STATE': {'changed': '*',
                                                       'has_metadata': 'F',
                                                       'is_directory': '*'},
                                             'STATE_OUT': {'changed': '=',
                                                           'has_metadata': '=',
                                                           'is_directory': '='}}],
            'AQ_DOWNLOAD_ERROR': [{'ACTION': 'md.remove_partial(uuid);',
                                    'ACTION_FUNC': 'remove_partial',
                                    'COMMENTS': 'error while downloading, remove the partial file',
                                    'PARAMETERS': {'hash_eq_local_hash': '*',
                                                   'hash_eq_server_hash': '*',
                                                   'not_authorized': 'T',
                                                   'not_available': 'F'},
                                    'STATE': {'changed': '*',
                                              'has_metadata': 'T',
                                              'is_directory': '*'},
                                    'STATE_OUT': {'changed': 'NONE',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}},
                                   {'ACTION': 'md.remove_partial(uuid);',
                                    'ACTION_FUNC': 'remove_partial',
                                    'COMMENTS': 'error while downloading, remove the partial file',
                                    'PARAMETERS': {'hash_eq_local_hash': '*',
                                                   'hash_eq_server_hash': '*',
                                                   'not_authorized': 'F',
                                                   'not_available': 'T'},
                                    'STATE': {'changed': '*',
                                              'has_metadata': 'T',
                                              'is_directory': '*'},
                                    'STATE_OUT': {'changed': 'NONE',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}},
                                   {'ACTION': 'NA',
                                    'ACTION_FUNC': '',
                                    'COMMENTS': '',
                                    'PARAMETERS': {'hash_eq_local_hash': '*',
                                                   'hash_eq_server_hash': '*',
                                                   'not_authorized': 'T',
                                                   'not_available': 'T'},
                                    'STATE': {'changed': '*',
                                              'has_metadata': 'T',
                                              'is_directory': '*'},
                                    'STATE_OUT': {'changed': '*',
                                                  'has_metadata': '*',
                                                  'is_directory': '*'}},
                                   {'ACTION': 'PANIC',
                                    'ACTION_FUNC': 'remove_partial',
                                    'COMMENTS': 'Should DESPAIR, but ATM we handle this in the handle_AQ_DOWNLOAD_ERROR as we have an extra error type returned by AQ when the .partial file is deleted by the user',
                                    'PARAMETERS': {'hash_eq_local_hash': '*',
                                                   'hash_eq_server_hash': '*',
                                                   'not_authorized': 'F',
                                                   'not_available': 'F'},
                                    'STATE': {'changed': '*',
                                              'has_metadata': 'T',
                                              'is_directory': '*'},
                                    'STATE_OUT': {'changed': 'NONE',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}},
                                   {'ACTION': 'NA',
                                    'ACTION_FUNC': '',
                                    'COMMENTS': '',
                                    'PARAMETERS': {'hash_eq_local_hash': '*',
                                                   'hash_eq_server_hash': '*',
                                                   'not_authorized': '*',
                                                   'not_available': 'NA'},
                                    'STATE': {'changed': '*',
                                              'has_metadata': 'T',
                                              'is_directory': '*'},
                                    'STATE_OUT': {'changed': '*',
                                                  'has_metadata': '*',
                                                  'is_directory': '*'}},
                                   {'ACTION': 'NA',
                                    'ACTION_FUNC': '',
                                    'COMMENTS': '',
                                    'PARAMETERS': {'hash_eq_local_hash': '*',
                                                   'hash_eq_server_hash': '*',
                                                   'not_authorized': 'NA',
                                                   'not_available': '*'},
                                    'STATE': {'changed': '*',
                                              'has_metadata': 'T',
                                              'is_directory': '*'},
                                    'STATE_OUT': {'changed': '*',
                                                  'has_metadata': '*',
                                                  'is_directory': '*'}},
                                   {'ACTION': 'pass',
                                    'ACTION_FUNC': 'nothing',
                                    'COMMENTS': '',
                                    'PARAMETERS': {'hash_eq_local_hash': '*',
                                                   'hash_eq_server_hash': '*',
                                                   'not_authorized': '*',
                                                   'not_available': '*'},
                                    'STATE': {'changed': '*',
                                              'has_metadata': 'F',
                                              'is_directory': '*'},
                                    'STATE_OUT': {'changed': '=',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}}],
            'AQ_DOWNLOAD_FINISHED': [{'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': '',
                                       'PARAMETERS': {'hash_eq_local_hash': '*',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': '*',
                                                 'has_metadata': 'T',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': '',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': '*',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': '*',
                                                 'has_metadata': 'T',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'pass',
                                       'ACTION_FUNC': 'nothing',
                                       'COMMENTS': 'file was removed while we where downloading',
                                       'PARAMETERS': {'hash_eq_local_hash': '*',
                                                      'hash_eq_server_hash': '*',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'NA',
                                                 'has_metadata': 'F',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'pass',
                                       'ACTION_FUNC': 'nothing',
                                       'COMMENTS': 'cancelled by e.g. SV_HASH_NEW',
                                       'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                      'hash_eq_server_hash': 'T',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'NONE',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': 'NONE, T, F is a falacy (NONE implies server_hash == local_hash)',
                                       'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                      'hash_eq_server_hash': 'T',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'NONE',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': 'NONE, F, T is a falacy (NONE implies server_hash == local_hash)',
                                       'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                      'hash_eq_server_hash': 'F',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'NONE',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}},
                                      {'ACTION': 'pass',
                                       'ACTION_FUNC': 'nothing',
                                       'COMMENTS': 'cancelled by e.g. SV_HASH_NEW',
                                       'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                      'hash_eq_server_hash': 'F',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'NONE',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': 'SERVER, T, T is a falacy (SERVER implies server_hash != local_hash)',
                                       'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                      'hash_eq_server_hash': 'T',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'SERVER',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}},
                                      {'ACTION': 'md.commit_partial(uuid, local_hash=hash)',
                                       'ACTION_FUNC': 'commit_file',
                                       'COMMENTS': 'this is the vainilla case',
                                       'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                      'hash_eq_server_hash': 'T',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'SERVER',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': 'NONE',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': '',
                                       'ACTION_FUNC': 'nothing',
                                       'COMMENTS': 'not what we want',
                                       'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                      'hash_eq_server_hash': 'F',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'SERVER',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': 'LOCAL',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'pass',
                                       'ACTION_FUNC': 'nothing',
                                       'COMMENTS': 'another download is already in progress',
                                       'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                      'hash_eq_server_hash': 'F',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'SERVER',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': 'LOCAL, T, T is a falacy (LOCAL implies server_hash != local_hash)',
                                       'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                      'hash_eq_server_hash': 'T',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'LOCAL',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}},
                                      {'ACTION': 'pass',
                                       'ACTION_FUNC': 'nothing',
                                       'COMMENTS': 'cancelled by e.g. SV_HASH_NEW',
                                       'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                      'hash_eq_server_hash': 'T',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'LOCAL',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'pass',
                                       'ACTION_FUNC': 'nothing',
                                       'COMMENTS': 'cancelled by e.g. SV_HASH_NEW',
                                       'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                      'hash_eq_server_hash': 'F',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'LOCAL',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'pass',
                                       'ACTION_FUNC': 'nothing',
                                       'COMMENTS': 'cancelled by e.g. SV_HASH_NEW',
                                       'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                      'hash_eq_server_hash': 'F',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'LOCAL',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'F'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'pass',
                                       'ACTION_FUNC': 'DESPAIR',
                                       'COMMENTS': 'we dont download directories anymore',
                                       'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                                      'hash_eq_server_hash': '!NA',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'NONE',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'T'},
                                       'STATE_OUT': {'changed': '=',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'merge_from_partial(uuid)',
                                       'ACTION_FUNC': 'DESPAIR',
                                       'COMMENTS': 'we dont download directories anymore',
                                       'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                                      'hash_eq_server_hash': 'T',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'SERVER',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'T'},
                                       'STATE_OUT': {'changed': 'NONE',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}},
                                      {'ACTION': 'pass',
                                       'ACTION_FUNC': 'DESPAIR',
                                       'COMMENTS': 'we dont download directories anymore',
                                       'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                                      'hash_eq_server_hash': 'F',
                                                      'not_authorized': 'NA',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'SERVER',
                                                 'has_metadata': 'T',
                                                 'is_directory': 'T'},
                                       'STATE_OUT': {'changed': 'SERVER',
                                                     'has_metadata': '=',
                                                     'is_directory': '='}}],
            'AQ_FILE_DELETE_ERROR': [{'ACTION': 'md.create(path=path, uuid=uuid, type=type) aq.query(uuid=uuid)',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': 'the user deleted something we couldnt delete from the server. Re create.',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'T',
                                                      'not_available': 'F'},
                                       'STATE': {'changed': 'NA',
                                                 'has_metadata': 'F',
                                                 'is_directory': 'NA'},
                                       'STATE_OUT': {'changed': 'NONE',
                                                     'has_metadata': 'T',
                                                     'is_directory': 'F'}},
                                      {'ACTION': 'md.create(path=path, uuid=uuid, type=type) aq.query(uuid=uuid)',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': 'the user deleted something we couldnt delete from the server. Re create.',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'F',
                                                      'not_available': 'T'},
                                       'STATE': {'changed': 'NA',
                                                 'has_metadata': 'F',
                                                 'is_directory': 'NA'},
                                       'STATE_OUT': {'changed': 'NONE',
                                                     'has_metadata': 'T',
                                                     'is_directory': '='}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': '',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'NA',
                                                      'not_available': '*'},
                                       'STATE': {'changed': 'NA',
                                                 'has_metadata': 'F',
                                                 'is_directory': 'NA'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': '',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': '*',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': 'NA',
                                                 'has_metadata': 'F',
                                                 'is_directory': 'NA'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': '',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': '*',
                                                      'not_available': 'NA'},
                                       'STATE': {'changed': '*',
                                                 'has_metadata': 'T',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': '',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'NA',
                                                      'not_available': '*'},
                                       'STATE': {'changed': '*',
                                                 'has_metadata': 'T',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}},
                                      {'ACTION': 'CONFLICT, recreate from deleted uuid',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': 'the user deleted something we could not delete from the server and replaced it with stuff. Move user files to conflict and re download stuff from the server',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'F',
                                                      'not_available': 'T'},
                                       'STATE': {'changed': '!SERVER',
                                                 'has_metadata': 'T',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': 'NONE',
                                                     'has_metadata': 'T',
                                                     'is_directory': 'F'}},
                                      {'ACTION': 'DESPAIR',
                                       'ACTION_FUNC': 'DESPAIR',
                                       'COMMENTS': 'the user deleted something we could not delete from the server and replaced it with stuff. Move user files to conflict and re download stuff from the server',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'F',
                                                      'not_available': 'T'},
                                       'STATE': {'changed': 'SERVER',
                                                 'has_metadata': 'T',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}},
                                      {'ACTION': 'CONFLICT',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': 'the user deleted something we could not delete from the server and replaced it with stuff. Move user files to conflict and re download stuff from the server',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'T',
                                                      'not_available': 'F'},
                                       'STATE': {'changed': '*',
                                                 'has_metadata': 'T',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': 'NONE',
                                                     'has_metadata': 'T',
                                                     'is_directory': 'T'}},
                                      {'ACTION': 'PANIC',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': '',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'F',
                                                      'not_available': 'F'},
                                       'STATE': {'changed': '*',
                                                 'has_metadata': '*',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': 'NONE',
                                                     'has_metadata': 'T',
                                                     'is_directory': 'F'}},
                                      {'ACTION': 'NA',
                                       'ACTION_FUNC': '',
                                       'COMMENTS': '',
                                       'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                      'hash_eq_server_hash': 'NA',
                                                      'not_authorized': 'T',
                                                      'not_available': 'T'},
                                       'STATE': {'changed': '*',
                                                 'has_metadata': '*',
                                                 'is_directory': '*'},
                                       'STATE_OUT': {'changed': '*',
                                                     'has_metadata': '*',
                                                     'is_directory': '*'}}],
            'AQ_FILE_DELETE_OK': [{'ACTION': 'pass',
                                    'ACTION_FUNC': 'nothing',
                                    'COMMENTS': 'vanilla case',
                                    'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                   'hash_eq_server_hash': 'NA',
                                                   'not_authorized': 'NA',
                                                   'not_available': 'NA'},
                                    'STATE': {'changed': 'NA',
                                              'has_metadata': 'F',
                                              'is_directory': 'NA'},
                                    'STATE_OUT': {'changed': '=',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}},
                                   {'ACTION': 'pass',
                                    'ACTION_FUNC': 'nothing',
                                    'COMMENTS': '/c',
                                    'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                   'hash_eq_server_hash': 'NA',
                                                   'not_authorized': 'NA',
                                                   'not_available': 'NA'},
                                    'STATE': {'changed': 'NONE',
                                              'has_metadata': 'T',
                                              'is_directory': 'F'},
                                    'STATE_OUT': {'changed': '=',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}},
                                   {'ACTION': 'pass',
                                    'ACTION_FUNC': 'nothing',
                                    'COMMENTS': 'we deleted something the user recreated, someone else is taking care of uploading this changes',
                                    'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                   'hash_eq_server_hash': 'NA',
                                                   'not_authorized': 'NA',
                                                   'not_available': 'NA'},
                                    'STATE': {'changed': 'LOCAL',
                                              'has_metadata': 'T',
                                              'is_directory': 'F'},
                                    'STATE_OUT': {'changed': '=',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}},
                                   {'ACTION': 'DESPAIR',
                                    'ACTION_FUNC': 'DESPAIR',
                                    'COMMENTS': 'somehow we lost ordering of stuff and we got a new file and changes since we tried to delete this file',
                                    'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                   'hash_eq_server_hash': 'NA',
                                                   'not_authorized': 'NA',
                                                   'not_available': 'NA'},
                                    'STATE': {'changed': 'SERVER',
                                              'has_metadata': 'T',
                                              'is_directory': '*'},
                                    'STATE_OUT': {'changed': '*',
                                                  'has_metadata': '*',
                                                  'is_directory': '*'}},
                                   {'ACTION': 'pass',
                                    'ACTION_FUNC': 'nothing',
                                    'COMMENTS': '',
                                    'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                   'hash_eq_server_hash': 'NA',
                                                   'not_authorized': 'NA',
                                                   'not_available': 'NA'},
                                    'STATE': {'changed': '!SERVER',
                                              'has_metadata': 'T',
                                              'is_directory': 'T'},
                                    'STATE_OUT': {'changed': '=',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}}],
            'AQ_FILE_MOVE_OK': [{'ACTION': '',
                                  'ACTION_FUNC': 'nothing',
                                  'COMMENTS': 'deleted locally',
                                  'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                 'hash_eq_server_hash': 'NA',
                                                 'not_authorized': 'NA',
                                                 'not_available': 'NA'},
                                  'STATE': {'changed': 'NA',
                                            'has_metadata': 'F',
                                            'is_directory': 'NA'},
                                  'STATE_OUT': {'changed': '*',
                                                'has_metadata': '*',
                                                'is_directory': '*'}},
                                 {'ACTION': '',
                                  'ACTION_FUNC': 'nothing',
                                  'COMMENTS': 'vanilla case',
                                  'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                 'hash_eq_server_hash': 'NA',
                                                 'not_authorized': 'NA',
                                                 'not_available': 'NA'},
                                  'STATE': {'changed': '*',
                                            'has_metadata': 'T',
                                            'is_directory': '*'},
                                  'STATE_OUT': {'changed': '=',
                                                'has_metadata': 'T',
                                                'is_directory': '='}}],
            'AQ_FILE_NEW_ERROR': [{'ACTION': 'pass',
                                    'ACTION_FUNC': 'release_marker_error',
                                    'COMMENTS': '',
                                    'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                   'hash_eq_server_hash': 'NA',
                                                   'not_authorized': '*',
                                                   'not_available': '*'},
                                    'STATE': {'changed': 'NA',
                                              'has_metadata': 'F',
                                              'is_directory': 'NA'},
                                    'STATE_OUT': {'changed': '=',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}},
                                   {'ACTION': 'CONFLICT',
                                    'ACTION_FUNC': 'filedir_error_in_creation',
                                    'COMMENTS': '',
                                    'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                   'hash_eq_server_hash': 'NA',
                                                   'not_authorized': '*',
                                                   'not_available': '*'},
                                    'STATE': {'changed': '*',
                                              'has_metadata': '*',
                                              'is_directory': 'F'},
                                    'STATE_OUT': {'changed': 'NA',
                                                  'has_metadata': 'F',
                                                  'is_directory': 'NA'}},
                                   {'ACTION': 'pass',
                                    'ACTION_FUNC': 'release_marker_error',
                                    'COMMENTS': '',
                                    'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                   'hash_eq_server_hash': 'NA',
                                                   'not_authorized': '*',
                                                   'not_available': '*'},
                                    'STATE': {'changed': '*',
                                              'has_metadata': '*',
                                              'is_directory': 'T'},
                                    'STATE_OUT': {'changed': '=',
                                                  'has_metadata': '=',
                                                  'is_directory': '='}}],
            'AQ_FILE_NEW_OK': [{'ACTION': 'md.set(mdid, server_uuid=server_uuid)',
                                 'ACTION_FUNC': 'new_local_file_created',
                                 'COMMENTS': '',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'NONE',
                                           'has_metadata': 'T',
                                           'is_directory': 'F'},
                                 'STATE_OUT': {'changed': '=',
                                               'has_metadata': '=',
                                               'is_directory': '='}},
                                {'ACTION': 'md.set(mdid, server_uuid=server_uuid)',
                                 'ACTION_FUNC': 'new_local_file_created',
                                 'COMMENTS': 'we got IN_FILE_CHANGED and HQ_HASH_NEW between IN_FILE_NEW and AQ_FILE_NEW_OK',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'LOCAL',
                                           'has_metadata': 'T',
                                           'is_directory': 'F'},
                                 'STATE_OUT': {'changed': '=',
                                               'has_metadata': '=',
                                               'is_directory': '='}},
                                {'ACTION': 'aq.uuid_map.set(marker, new_id)',
                                 'ACTION_FUNC': 'release_marker_ok',
                                 'COMMENTS': 'file deleted locally',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'NA',
                                           'has_metadata': 'F',
                                           'is_directory': 'NA'},
                                 'STATE_OUT': {'changed': '=',
                                               'has_metadata': '=',
                                               'is_directory': '='}},
                                {'ACTION': "Node got node_id with a SV_FILE_NEW and now it's uploading something",
                                 'ACTION_FUNC': 'nothing',
                                 'COMMENTS': '',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'SERVER',
                                           'has_metadata': 'T',
                                           'is_directory': 'F'},
                                 'STATE_OUT': {'changed': '=',
                                               'has_metadata': '=',
                                               'is_directory': '='}},
                                {'ACTION': 'aq.uuid_map.set(marker, new_id)',
                                 'ACTION_FUNC': 'release_marker_ok',
                                 'COMMENTS': "it's a directory now",
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': '*',
                                           'has_metadata': 'T',
                                           'is_directory': 'T'},
                                 'STATE_OUT': {'changed': '=',
                                               'has_metadata': '=',
                                               'is_directory': '='}}],
            'AQ_MOVE_ERROR': [{'ACTION': 'md.create(path=path, uuid=target_uuid, type=type)\naq.query(uuid=target_uuid)',
                                'ACTION_FUNC': 'clean_move_limbo',
                                'COMMENTS': 'deleted after local move and move failed on server. ',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NA',
                                          'has_metadata': 'F',
                                          'is_directory': 'NA'},
                                'STATE_OUT': {'changed': '=',
                                              'has_metadata': '=',
                                              'is_directory': '='}},
                               {'ACTION': 'move file to conflict\nquery(uuid=source.parent)\nquery(uuid=dest.parent)\n',
                                'ACTION_FUNC': 'clean_move_limbo',
                                'COMMENTS': 'something bad happened. Conflict and rescan',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': '*',
                                          'has_metadata': 'T',
                                          'is_directory': '*'},
                                'STATE_OUT': {'changed': '=',
                                              'has_metadata': '=',
                                              'is_directory': '='}}],
            'AQ_MOVE_OK': [{'ACTION': 'pass',
                             'ACTION_FUNC': 'clean_move_limbo',
                             'COMMENTS': 'deleted after move',
                             'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                            'hash_eq_server_hash': 'NA',
                                            'not_authorized': 'NA',
                                            'not_available': 'NA'},
                             'STATE': {'changed': 'NA',
                                       'has_metadata': 'F',
                                       'is_directory': 'NA'},
                             'STATE_OUT': {'changed': '=',
                                           'has_metadata': '=',
                                           'is_directory': '='}},
                            {'ACTION': 'pass',
                             'ACTION_FUNC': 'clean_move_limbo',
                             'COMMENTS': 'everything good',
                             'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                            'hash_eq_server_hash': 'NA',
                                            'not_authorized': 'NA',
                                            'not_available': 'NA'},
                             'STATE': {'changed': '*',
                                       'has_metadata': 'T',
                                       'is_directory': '*'},
                             'STATE_OUT': {'changed': '=',
                                           'has_metadata': '=',
                                           'is_directory': '='}}],
            'AQ_UNLINK_ERROR': [{'ACTION': 'remove the node from trash',
                                  'ACTION_FUNC': 'remove_trash',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                 'hash_eq_server_hash': 'NA',
                                                 'not_authorized': 'NA',
                                                 'not_available': 'NA'},
                                  'STATE': {'changed': '*',
                                            'has_metadata': '*',
                                            'is_directory': '*'},
                                  'STATE_OUT': {'changed': '=',
                                                'has_metadata': '=',
                                                'is_directory': '='}}],
            'AQ_UNLINK_OK': [{'ACTION': 'remove the node from trash',
                               'ACTION_FUNC': 'remove_trash',
                               'COMMENTS': '',
                               'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                              'hash_eq_server_hash': 'NA',
                                              'not_authorized': 'NA',
                                              'not_available': 'NA'},
                               'STATE': {'changed': '*',
                                         'has_metadata': '*',
                                         'is_directory': '*'},
                               'STATE_OUT': {'changed': '=',
                                             'has_metadata': '=',
                                             'is_directory': '='}}],
            'AQ_UPLOAD_ERROR': [{'ACTION': 'pass',
                                  'ACTION_FUNC': 'nothing',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': '*',
                                                 'hash_eq_server_hash': '*',
                                                 'not_authorized': '*',
                                                 'not_available': '*'},
                                  'STATE': {'changed': 'NA',
                                            'has_metadata': 'F',
                                            'is_directory': 'NA'},
                                  'STATE_OUT': {'changed': '=',
                                                'has_metadata': '=',
                                                'is_directory': '='}},
                                 {'ACTION': 'NA',
                                  'ACTION_FUNC': '',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': '*',
                                                 'hash_eq_server_hash': '*',
                                                 'not_authorized': '*',
                                                 'not_available': 'NA'},
                                  'STATE': {'changed': '*',
                                            'has_metadata': 'T',
                                            'is_directory': '*'},
                                  'STATE_OUT': {'changed': '*',
                                                'has_metadata': '*',
                                                'is_directory': '*'}},
                                 {'ACTION': 'NA',
                                  'ACTION_FUNC': '',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': '*',
                                                 'hash_eq_server_hash': '*',
                                                 'not_authorized': 'NA',
                                                 'not_available': '*'},
                                  'STATE': {'changed': '*',
                                            'has_metadata': 'T',
                                            'is_directory': '*'},
                                  'STATE_OUT': {'changed': '*',
                                                'has_metadata': '*',
                                                'is_directory': '*'}},
                                 {'ACTION': '',
                                  'ACTION_FUNC': 'nothing',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': '*',
                                                 'hash_eq_server_hash': '*',
                                                 'not_authorized': 'F',
                                                 'not_available': 'F'},
                                  'STATE': {'changed': '*',
                                            'has_metadata': 'T',
                                            'is_directory': 'F'},
                                  'STATE_OUT': {'changed': '=',
                                                'has_metadata': '=',
                                                'is_directory': '='}},
                                 {'ACTION': 'NA',
                                  'ACTION_FUNC': '',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': '*',
                                                 'hash_eq_server_hash': '*',
                                                 'not_authorized': 'T',
                                                 'not_available': 'T'},
                                  'STATE': {'changed': '*',
                                            'has_metadata': 'T',
                                            'is_directory': 'F'},
                                  'STATE_OUT': {'changed': '*',
                                                'has_metadata': '*',
                                                'is_directory': '*'}},
                                 {'ACTION': 'pass',
                                  'ACTION_FUNC': 'nothing',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': '*',
                                                 'hash_eq_server_hash': '*',
                                                 'not_authorized': 'F',
                                                 'not_available': 'T'},
                                  'STATE': {'changed': '*',
                                            'has_metadata': 'T',
                                            'is_directory': 'F'},
                                  'STATE_OUT': {'changed': '=',
                                                'has_metadata': '=',
                                                'is_directory': '='}},
                                 {'ACTION': 'pass',
                                  'ACTION_FUNC': 'nothing',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': '*',
                                                 'hash_eq_server_hash': '*',
                                                 'not_authorized': 'T',
                                                 'not_available': 'F'},
                                  'STATE': {'changed': '*',
                                            'has_metadata': 'T',
                                            'is_directory': 'F'},
                                  'STATE_OUT': {'changed': '=',
                                                'has_metadata': '=',
                                                'is_directory': '='}},
                                 {'ACTION': 'DESPAIR',
                                  'ACTION_FUNC': 'DESPAIR',
                                  'COMMENTS': 'we never try to upload directories',
                                  'PARAMETERS': {'hash_eq_local_hash': '*',
                                                 'hash_eq_server_hash': '*',
                                                 'not_authorized': '!NA',
                                                 'not_available': '!NA'},
                                  'STATE': {'changed': '*',
                                            'has_metadata': 'T',
                                            'is_directory': 'T'},
                                  'STATE_OUT': {'changed': '*',
                                                'has_metadata': '*',
                                                'is_directory': '*'}}],
            'AQ_UPLOAD_FINISHED': [{'ACTION': 'pass',
                                     'ACTION_FUNC': 'nothing',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': '*',
                                                    'hash_eq_server_hash': '*',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'NA',
                                               'has_metadata': 'F',
                                               'is_directory': 'NA'},
                                     'STATE_OUT': {'changed': '=',
                                                   'has_metadata': '=',
                                                   'is_directory': '='}},
                                    {'ACTION': 'NA',
                                     'ACTION_FUNC': '',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                    'hash_eq_server_hash': '*',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': '*',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': '*',
                                                   'has_metadata': '*',
                                                   'is_directory': '*'}},
                                    {'ACTION': 'NA',
                                     'ACTION_FUNC': '',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': '*',
                                                    'hash_eq_server_hash': 'NA',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': '*',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': '*',
                                                   'has_metadata': '*',
                                                   'is_directory': '*'}},
                                    {'ACTION': 'md.upload_finished(mdid, server_hash=hash)',
                                     'ACTION_FUNC': 'commit_upload',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                    'hash_eq_server_hash': 'T',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'NONE',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': '=',
                                                   'has_metadata': '=',
                                                   'is_directory': '='}},
                                    {'ACTION': 'NA',
                                     'ACTION_FUNC': '',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                    'hash_eq_server_hash': 'T',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'NONE',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': '*',
                                                   'has_metadata': '*',
                                                   'is_directory': '*'}},
                                    {'ACTION': 'NA',
                                     'ACTION_FUNC': '',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                    'hash_eq_server_hash': 'F',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'NONE',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': '*',
                                                   'has_metadata': '*',
                                                   'is_directory': '*'}},
                                    {'ACTION': 'md.upload_finished(mdid, server_hash=hash)',
                                     'ACTION_FUNC': 'commit_upload',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                    'hash_eq_server_hash': 'F',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'NONE',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': 'LOCAL',
                                                   'has_metadata': '=',
                                                   'is_directory': '='}},
                                    {'ACTION': 'NA',
                                     'ACTION_FUNC': '',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                    'hash_eq_server_hash': 'T',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'SERVER',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': '*',
                                                   'has_metadata': '*',
                                                   'is_directory': '*'}},
                                    {'ACTION': 'NA',
                                     'ACTION_FUNC': '',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                    'hash_eq_server_hash': 'T',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'LOCAL',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': '*',
                                                   'has_metadata': '*',
                                                   'is_directory': '*'}},
                                    {'ACTION': 'md.upload_finished(mdid, server_hash=hash)',
                                     'ACTION_FUNC': 'commit_upload',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                    'hash_eq_server_hash': 'T',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'SERVER',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': '=',
                                                   'has_metadata': '=',
                                                   'is_directory': '='}},
                                    {'ACTION': 'md.upload_finished(mdid, server_hash=hash)',
                                     'ACTION_FUNC': 'reput_file_from_ok',
                                     'COMMENTS': 'we finished a download, but this download should have been cancelled. So the real upload will conflict. Reschedule upload.',
                                     'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                    'hash_eq_server_hash': 'T',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'LOCAL',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': 'NONE',
                                                   'has_metadata': '=',
                                                   'is_directory': '='}},
                                    {'ACTION': 'cancel download; commit upload',
                                     'ACTION_FUNC': 'cancel_and_commit',
                                     'COMMENTS': 'we couldnt cancel an upload and we overwrote what was on the server',
                                     'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                    'hash_eq_server_hash': 'F',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'SERVER',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': 'NONE',
                                                   'has_metadata': 'T',
                                                   'is_directory': '='}},
                                    {'ACTION': 'md.upload_finished(mdid, server_hash=hash)',
                                     'ACTION_FUNC': 'commit_upload',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'T',
                                                    'hash_eq_server_hash': 'F',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'LOCAL',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': 'NONE',
                                                   'has_metadata': '=',
                                                   'is_directory': '='}},
                                    {'ACTION': 'md.upload_finished(mdid, server_hash=hash)',
                                     'ACTION_FUNC': 'commit_upload',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                    'hash_eq_server_hash': 'F',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'SERVER',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': 'SERVER',
                                                   'has_metadata': '=',
                                                   'is_directory': '='}},
                                    {'ACTION': 'md.upload_finished(mdid, server_hash=hash)',
                                     'ACTION_FUNC': 'reput_file_from_ok',
                                     'COMMENTS': '',
                                     'PARAMETERS': {'hash_eq_local_hash': 'F',
                                                    'hash_eq_server_hash': 'F',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': 'LOCAL',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'},
                                     'STATE_OUT': {'changed': 'NONE',
                                                   'has_metadata': '=',
                                                   'is_directory': '='}},
                                    {'ACTION': 'DESPAIR',
                                     'ACTION_FUNC': 'DESPAIR',
                                     'COMMENTS': 'we never try to upload directories',
                                     'PARAMETERS': {'hash_eq_local_hash': '*',
                                                    'hash_eq_server_hash': '*',
                                                    'not_authorized': 'NA',
                                                    'not_available': 'NA'},
                                     'STATE': {'changed': '*',
                                               'has_metadata': 'T',
                                               'is_directory': 'T'},
                                     'STATE_OUT': {'changed': '*',
                                                   'has_metadata': '*',
                                                   'is_directory': '*'}}],
            'FS_DIR_CREATE': [{'ACTION': 'mdid = md.create(path=path)\naq.makefile(mdid)',
                                'ACTION_FUNC': 'new_local_dir',
                                'COMMENTS': '',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NA',
                                          'has_metadata': 'F',
                                          'is_directory': 'NA'},
                                'STATE_OUT': {'changed': 'NONE',
                                              'has_metadata': 'T',
                                              'is_directory': 'T'}},
                               {'ACTION': 'pass',
                                'ACTION_FUNC': 'nothing',
                                'COMMENTS': 'duplicate IN_DIRECTORY_NEW',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'SERVER',
                                          'has_metadata': 'T',
                                          'is_directory': '*'},
                                'STATE_OUT': {'changed': '=',
                                              'has_metadata': '=',
                                              'is_directory': '='}},
                               {'ACTION': 'pass',
                                'ACTION_FUNC': 'nothing',
                                'COMMENTS': 'duplicate IN_DIRECTORY_NEW',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NONE',
                                          'has_metadata': 'T',
                                          'is_directory': 'F'},
                                'STATE_OUT': {'changed': 'NONE',
                                              'has_metadata': 'T',
                                              'is_directory': 'F'}},
                               {'ACTION': 'DESPAIR',
                                'ACTION_FUNC': 'DESPAIR',
                                'COMMENTS': '...?',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'LOCAL',
                                          'has_metadata': 'T',
                                          'is_directory': 'F'},
                                'STATE_OUT': {'changed': '*',
                                              'has_metadata': '*',
                                              'is_directory': '*'}},
                               {'ACTION': 'pass',
                                'ACTION_FUNC': 'nothing',
                                'COMMENTS': 'duplicate IN_DIRECTORY_NEW',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NONE',
                                          'has_metadata': 'T',
                                          'is_directory': 'T'},
                                'STATE_OUT': {'changed': 'NONE',
                                              'has_metadata': 'T',
                                              'is_directory': 'T'}}],
            'FS_DIR_DELETE': [{'ACTION': 'pass',
                                'ACTION_FUNC': 'nothing',
                                'COMMENTS': 'this is the result of a delete we did',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NA',
                                          'has_metadata': 'F',
                                          'is_directory': 'NA'},
                                'STATE_OUT': {'changed': '=',
                                              'has_metadata': '=',
                                              'is_directory': '='}},
                               {'ACTION': 'aq.delete_file(uuid, type=type); md.remove(uuid)',
                                'ACTION_FUNC': 'delete_on_server',
                                'COMMENTS': 'when deleting files we remove the metadata, server rescan will find this again and downloadi it if we are shutdown before this delete has gone up. Generations may break this. ',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NONE',
                                          'has_metadata': 'T',
                                          'is_directory': '*'},
                                'STATE_OUT': {'changed': 'NA',
                                              'has_metadata': 'F',
                                              'is_directory': 'NA'}},
                               {'ACTION': '',
                                'ACTION_FUNC': 'DESPAIR',
                                'COMMENTS': 'delete of file when it should be a dir is bad',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'LOCAL',
                                          'has_metadata': 'T',
                                          'is_directory': 'F'},
                                'STATE_OUT': {'changed': 'NA',
                                              'has_metadata': 'F',
                                              'is_directory': 'NA'}},
                               {'ACTION': '',
                                'ACTION_FUNC': 'DESPAIR',
                                'COMMENTS': 'delete of file when it should be a dir is bad',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'SERVER',
                                          'has_metadata': 'T',
                                          'is_directory': 'F'},
                                'STATE_OUT': {'changed': 'NA',
                                              'has_metadata': 'F',
                                              'is_directory': 'NA'}},
                               {'ACTION': 'md.cancel_download(md); md.remove(uuid)',
                                'ACTION_FUNC': 'deleted_dir_while_downloading',
                                'COMMENTS': '',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'SERVER',
                                          'has_metadata': 'T',
                                          'is_directory': 'T'},
                                'STATE_OUT': {'changed': 'NA',
                                              'has_metadata': 'F',
                                              'is_directory': 'NA'}}],
            'FS_DIR_MOVE': [{'ACTION': '',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': 'side efect of local move',
                              'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                             'hash_eq_server_hash': 'NA',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NA',
                                        'has_metadata': 'F',
                                        'is_directory': 'NA'},
                              'STATE_OUT': {'changed': 'NA',
                                            'has_metadata': 'F',
                                            'is_directory': 'NA'}},
                             {'ACTION': 'aq.move()',
                              'ACTION_FUNC': 'client_moved',
                              'COMMENTS': 'vanilla case',
                              'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                             'hash_eq_server_hash': 'NA',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': '*'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': 'T',
                                            'is_directory': '='}},
                             {'ACTION': 'cancel upload; move; restart upload',
                              'ACTION_FUNC': 'moved_dirty_local',
                              'COMMENTS': 'we got a move while we were downloading it',
                              'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                             'hash_eq_server_hash': 'NA',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'LOCAL',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'NONE',
                                            'has_metadata': 'T',
                                            'is_directory': 'F'}},
                             {'ACTION': 'cancel_download; move; query',
                              'ACTION_FUNC': 'moved_dirty_server',
                              'COMMENTS': 'we got a move while we were downloading it',
                              'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                             'hash_eq_server_hash': 'NA',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': '*'},
                              'STATE_OUT': {'changed': 'NONE',
                                            'has_metadata': 'T',
                                            'is_directory': '='}}],
            'FS_FILE_CLOSE_WRITE': [{'ACTION': 'pass',
                                      'ACTION_FUNC': 'nothing',
                                      'COMMENTS': 'changes from a file that no longer exists',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'NA',
                                                     'not_available': 'NA'},
                                      'STATE': {'changed': 'NA',
                                                'has_metadata': 'F',
                                                'is_directory': '*'},
                                      'STATE_OUT': {'changed': '=',
                                                    'has_metadata': '=',
                                                    'is_directory': '='}},
                                     {'ACTION': 'DESPAIR',
                                      'ACTION_FUNC': 'DESPAIR',
                                      'COMMENTS': 'event cant happen in directories',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'NA',
                                                     'not_available': 'NA'},
                                      'STATE': {'changed': '*',
                                                'has_metadata': 'T',
                                                'is_directory': 'T'},
                                      'STATE_OUT': {'changed': '*',
                                                    'has_metadata': '*',
                                                    'is_directory': '*'}},
                                     {'ACTION': 'hq.insert(path)',
                                      'ACTION_FUNC': 'calculate_hash',
                                      'COMMENTS': '',
                                      'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                     'hash_eq_server_hash': 'NA',
                                                     'not_authorized': 'NA',
                                                     'not_available': 'NA'},
                                      'STATE': {'changed': '*',
                                                'has_metadata': 'T',
                                                'is_directory': 'F'},
                                      'STATE_OUT': {'changed': '=',
                                                    'has_metadata': '=',
                                                    'is_directory': '='}}],
            'FS_FILE_CREATE': [{'ACTION': 'mdid = md.create(path=path)\naq.makefile(mdid)',
                                 'ACTION_FUNC': 'new_local_file',
                                 'COMMENTS': '',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'NA',
                                           'has_metadata': 'F',
                                           'is_directory': 'NA'},
                                 'STATE_OUT': {'changed': 'NONE',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'}},
                                {'ACTION': '',
                                 'ACTION_FUNC': 'nothing',
                                 'COMMENTS': 'ignore this. We created the file.',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'SERVER',
                                           'has_metadata': 'T',
                                           'is_directory': '*'},
                                 'STATE_OUT': {'changed': '=',
                                               'has_metadata': '=',
                                               'is_directory': '='}},
                                {'ACTION': 'pass',
                                 'ACTION_FUNC': 'nothing',
                                 'COMMENTS': "As we're ignoring some files, we are in the situation where some editors move the file to something we ignore, and then create the file again, so we receive the FS_FILE_CREATE for a node that we actually have",
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'NONE',
                                           'has_metadata': 'T',
                                           'is_directory': 'F'},
                                 'STATE_OUT': {'changed': '=',
                                               'has_metadata': '=',
                                               'is_directory': '='}},
                                {'ACTION': 'pass',
                                 'ACTION_FUNC': 'nothing',
                                 'COMMENTS': "Same as before, but we're uploading that node we already have.",
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'LOCAL',
                                           'has_metadata': 'T',
                                           'is_directory': 'F'},
                                 'STATE_OUT': {'changed': '=',
                                               'has_metadata': '=',
                                               'is_directory': '='}},
                                {'ACTION': 'log warning',
                                 'ACTION_FUNC': 'nothing',
                                 'COMMENTS': 'duplicate IN_FILE_NEW',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'NONE',
                                           'has_metadata': 'T',
                                           'is_directory': 'T'},
                                 'STATE_OUT': {'changed': 'NONE',
                                               'has_metadata': 'T',
                                               'is_directory': 'F'}}],
            'FS_FILE_DELETE': [{'ACTION': 'pass',
                                 'ACTION_FUNC': 'nothing',
                                 'COMMENTS': 'this is the result of a delete we did',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'NA',
                                           'has_metadata': 'F',
                                           'is_directory': 'NA'},
                                 'STATE_OUT': {'changed': '=',
                                               'has_metadata': '=',
                                               'is_directory': '='}},
                                {'ACTION': 'aq.delete_file(uuid, type=type); md.remove(uuid)',
                                 'ACTION_FUNC': 'delete_on_server',
                                 'COMMENTS': 'when deleting files we remove the metadata, server rescan will find this again and downloadi it if we are shutdown before this delete has gone up. Generations may break this. ',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'NONE',
                                           'has_metadata': 'T',
                                           'is_directory': '*'},
                                 'STATE_OUT': {'changed': 'NA',
                                               'has_metadata': 'F',
                                               'is_directory': 'NA'}},
                                {'ACTION': 'aq.cancel_upload(uuid); aq.delete_file(uuid); md.remove(uuid)',
                                 'ACTION_FUNC': 'cancel_upload_and_delete_on_server',
                                 'COMMENTS': '',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'LOCAL',
                                           'has_metadata': 'T',
                                           'is_directory': 'F'},
                                 'STATE_OUT': {'changed': 'NA',
                                               'has_metadata': 'F',
                                               'is_directory': 'NA'}},
                                {'ACTION': 'aq.cancel_download(uuid); aq.delete_file(uuid)\n md.remove(uuid)',
                                 'ACTION_FUNC': 'cancel_download_and_delete_on_server',
                                 'COMMENTS': 'This is policy. We could declare this to be a conflict. But we should assume that the client knows what he is doing',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'SERVER',
                                           'has_metadata': 'T',
                                           'is_directory': 'F'},
                                 'STATE_OUT': {'changed': 'NA',
                                               'has_metadata': 'F',
                                               'is_directory': 'NA'}},
                                {'ACTION': '',
                                 'ACTION_FUNC': 'DESPAIR',
                                 'COMMENTS': '',
                                 'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                'hash_eq_server_hash': 'NA',
                                                'not_authorized': 'NA',
                                                'not_available': 'NA'},
                                 'STATE': {'changed': 'SERVER',
                                           'has_metadata': 'T',
                                           'is_directory': 'T'},
                                 'STATE_OUT': {'changed': 'NA',
                                               'has_metadata': 'F',
                                               'is_directory': 'NA'}}],
            'FS_FILE_MOVE': [{'ACTION': '',
                               'ACTION_FUNC': 'nothing',
                               'COMMENTS': 'side efect of local move',
                               'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                              'hash_eq_server_hash': 'NA',
                                              'not_authorized': 'NA',
                                              'not_available': 'NA'},
                               'STATE': {'changed': 'NA',
                                         'has_metadata': 'F',
                                         'is_directory': 'NA'},
                               'STATE_OUT': {'changed': 'NA',
                                             'has_metadata': 'F',
                                             'is_directory': 'NA'}},
                              {'ACTION': 'aq.move()',
                               'ACTION_FUNC': 'client_moved',
                               'COMMENTS': 'vanilla case',
                               'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                              'hash_eq_server_hash': 'NA',
                                              'not_authorized': 'NA',
                                              'not_available': 'NA'},
                               'STATE': {'changed': 'NONE',
                                         'has_metadata': 'T',
                                         'is_directory': '*'},
                               'STATE_OUT': {'changed': '=',
                                             'has_metadata': 'T',
                                             'is_directory': '='}},
                              {'ACTION': 'cancel upload; move; restart upload',
                               'ACTION_FUNC': 'moved_dirty_local',
                               'COMMENTS': 'we got a move while we were downloading it',
                               'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                              'hash_eq_server_hash': 'NA',
                                              'not_authorized': 'NA',
                                              'not_available': 'NA'},
                               'STATE': {'changed': 'LOCAL',
                                         'has_metadata': 'T',
                                         'is_directory': 'F'},
                               'STATE_OUT': {'changed': 'NONE',
                                             'has_metadata': 'T',
                                             'is_directory': 'F'}},
                              {'ACTION': 'cancel_download; move; query',
                               'ACTION_FUNC': 'moved_dirty_server',
                               'COMMENTS': 'we got a move while we were downloading it',
                               'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                              'hash_eq_server_hash': 'NA',
                                              'not_authorized': 'NA',
                                              'not_available': 'NA'},
                               'STATE': {'changed': 'SERVER',
                                         'has_metadata': 'T',
                                         'is_directory': '*'},
                               'STATE_OUT': {'changed': 'NONE',
                                             'has_metadata': 'T',
                                             'is_directory': '='}}],
            'HQ_HASH_ERROR': [{'ACTION': '',
                                'ACTION_FUNC': 'nothing',
                                'COMMENTS': 'it was deleted at some point',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NA',
                                          'has_metadata': 'F',
                                          'is_directory': 'NA'},
                                'STATE_OUT': {'changed': 'NA',
                                              'has_metadata': 'F',
                                              'is_directory': 'NA'}},
                               {'ACTION': 'DESPAIR',
                                'ACTION_FUNC': 'DESPAIR',
                                'COMMENTS': 'we should never be hashing a directory',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': '*',
                                          'has_metadata': 'T',
                                          'is_directory': 'T'},
                                'STATE_OUT': {'changed': '*',
                                              'has_metadata': '*',
                                              'is_directory': '*'}},
                               {'ACTION': 'hq.insert(path)',
                                'ACTION_FUNC': 'calculate_hash',
                                'COMMENTS': 'we need to re send the hash to the HQ',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': '*',
                                          'has_metadata': 'T',
                                          'is_directory': 'F'},
                                'STATE_OUT': {'changed': '=',
                                              'has_metadata': '=',
                                              'is_directory': '='}}],
            'HQ_HASH_NEW': [{'ACTION': 'NA',
                              'ACTION_FUNC': '',
                              'COMMENTS': '',
                              'PARAMETERS': {'hash_eq_local_hash': '*',
                                             'hash_eq_server_hash': 'NA',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': '*',
                                        'has_metadata': 'T',
                                        'is_directory': '*'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'NA',
                              'ACTION_FUNC': '',
                              'COMMENTS': '',
                              'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                             'hash_eq_server_hash': '*',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': '*',
                                        'has_metadata': 'T',
                                        'is_directory': '*'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'md.set(mdid, stat=stat)',
                              'ACTION_FUNC': 'save_stat',
                              'COMMENTS': 'hash == local_hash == server_hash; nothing changed but the file was \u201ctouched\u201d',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': '',
                              'ACTION_FUNC': 'reput_file',
                              'COMMENTS': 'just to be on the safe side, we try to put the file again.',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'LOCAL',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'LOCAL',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'md.set(mdid, local_hash=hash)\naq.putfile(*mdid)',
                              'ACTION_FUNC': 'put_file',
                              'COMMENTS': 'plain \u201cuser modified the file on this machine\u201d case',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'LOCAL',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': '',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': 'we dont send directories to hq. This is old. Ignore.',
                              'PARAMETERS': {'hash_eq_local_hash': 'F',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'T'},
                              'STATE_OUT': {'changed': 'SERVER',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'NA',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': '',
                              'PARAMETERS': {'hash_eq_local_hash': 'T',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'T'},
                              'STATE_OUT': {'changed': '*',
                                            'has_metadata': '*',
                                            'is_directory': '*'}},
                             {'ACTION': 'pass',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': 'the directories are the same',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'T'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'md.set(mdid, local_hash=hash)\naq.putfile(*mdid)',
                              'ACTION_FUNC': 'reput_file',
                              'COMMENTS': 'another upload is in progress',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'LOCAL',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'LOCAL',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'md.set(mdid, local_hash=hash)\naq.cancel_download(mdid)',
                              'ACTION_FUNC': 'converges_to_server',
                              'COMMENTS': 'local file already has server changes that are being downloaded',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'NONE',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'CONFLICT',
                              'ACTION_FUNC': 'file_conflict',
                              'COMMENTS': 'local file was modified by the user while download of next version was in progress',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'SERVER',
                                            'has_metadata': 'T',
                                            'is_directory': '='}},
                             {'ACTION': '',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': 'we dont send directories to hq. This is old. Ignore.',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'T'},
                              'STATE_OUT': {'changed': 'NONE',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': '',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': 'we dont send directories to hq. This is old. Ignore.',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'T'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'pass',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': '',
                              'PARAMETERS': {'hash_eq_local_hash': '*',
                                             'hash_eq_server_hash': '*',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': '*',
                                        'has_metadata': 'F',
                                        'is_directory': '*'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}}],
            'LR_SCAN_ERROR': [{'ACTION': '',
                                'ACTION_FUNC': 'nothing',
                                'COMMENTS': 'it was deleted at some point',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': 'NA',
                                          'has_metadata': 'F',
                                          'is_directory': 'NA'},
                                'STATE_OUT': {'changed': 'NA',
                                              'has_metadata': 'F',
                                              'is_directory': 'NA'}},
                               {'ACTION': 'DESPAIR',
                                'ACTION_FUNC': 'DESPAIR',
                                'COMMENTS': 'we should never be local-scanning a file',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': '*',
                                          'has_metadata': 'T',
                                          'is_directory': 'F'},
                                'STATE_OUT': {'changed': '*',
                                              'has_metadata': '*',
                                              'is_directory': '*'}},
                               {'ACTION': 'RESCAN',
                                'ACTION_FUNC': 'rescan_dir',
                                'COMMENTS': 'we need to re start the local rescan',
                                'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                               'hash_eq_server_hash': 'NA',
                                               'not_authorized': 'NA',
                                               'not_available': 'NA'},
                                'STATE': {'changed': '*',
                                          'has_metadata': 'T',
                                          'is_directory': 'T'},
                                'STATE_OUT': {'changed': '=',
                                              'has_metadata': '=',
                                              'is_directory': '='}}],
            'SV_DIR_NEW': [{'ACTION': 'md.create(path=path, uuid=uuid, type=type)\naq.query(uuid=uuid)',
                             'ACTION_FUNC': 'new_dir',
                             'COMMENTS': 'good case, we send a query to see if there are anychanges we need to merge',
                             'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                            'hash_eq_server_hash': 'NA',
                                            'not_authorized': 'NA',
                                            'not_available': 'NA'},
                             'STATE': {'changed': 'NA',
                                       'has_metadata': 'F',
                                       'is_directory': 'NA'},
                             'STATE_OUT': {'changed': 'NONE',
                                           'has_metadata': 'T',
                                           'is_directory': 'T'}},
                            {'ACTION': 'CONFLICT',
                             'ACTION_FUNC': 'new_dir_on_server_with_local_file',
                             'COMMENTS': '',
                             'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                            'hash_eq_server_hash': 'NA',
                                            'not_authorized': 'NA',
                                            'not_available': 'NA'},
                             'STATE': {'changed': '*',
                                       'has_metadata': 'T',
                                       'is_directory': 'F'},
                             'STATE_OUT': {'changed': 'NONE',
                                           'has_metadata': 'T',
                                           'is_directory': 'T'}},
                            {'ACTION': 'list the dir to get new info and converge',
                             'ACTION_FUNC': 'new_dir_on_server_with_local_dir',
                             'COMMENTS': '',
                             'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                            'hash_eq_server_hash': 'NA',
                                            'not_authorized': 'NA',
                                            'not_available': 'NA'},
                             'STATE': {'changed': '*',
                                       'has_metadata': 'T',
                                       'is_directory': 'T'},
                             'STATE_OUT': {'changed': 'NONE',
                                           'has_metadata': 'T',
                                           'is_directory': 'T'}}],
            'SV_FILE_DELETED': [{'ACTION': 'pass',
                                  'ACTION_FUNC': 'nothing',
                                  'COMMENTS': 'we deleted something and the server did the same',
                                  'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                 'hash_eq_server_hash': 'NA',
                                                 'not_authorized': 'NA',
                                                 'not_available': 'NA'},
                                  'STATE': {'changed': 'NA',
                                            'has_metadata': 'F',
                                            'is_directory': 'NA'},
                                  'STATE_OUT': {'changed': '=',
                                                'has_metadata': '=',
                                                'is_directory': '='}},
                                 {'ACTION': 'md.remove(uuid)',
                                  'ACTION_FUNC': 'delete_file',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                 'hash_eq_server_hash': 'NA',
                                                 'not_authorized': 'NA',
                                                 'not_available': 'NA'},
                                  'STATE': {'changed': 'NONE',
                                            'has_metadata': 'T',
                                            'is_directory': '*'},
                                  'STATE_OUT': {'changed': 'NA',
                                                'has_metadata': 'F',
                                                'is_directory': 'NA'}},
                                 {'ACTION': 'CONFLICT; md.remove(uuid)',
                                  'ACTION_FUNC': 'conflict_and_delete',
                                  'COMMENTS': '',
                                  'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                 'hash_eq_server_hash': 'NA',
                                                 'not_authorized': 'NA',
                                                 'not_available': 'NA'},
                                  'STATE': {'changed': 'LOCAL',
                                            'has_metadata': 'T',
                                            'is_directory': 'F'},
                                  'STATE_OUT': {'changed': 'NA',
                                                'has_metadata': 'F',
                                                'is_directory': 'NA'}},
                                 {'ACTION': 'md.cancel_download(uuid); md.remove(uuid)',
                                  'ACTION_FUNC': 'file_gone_wile_downloading',
                                  'COMMENTS': 'we are still downloading some content we dont care about anymore',
                                  'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                 'hash_eq_server_hash': 'NA',
                                                 'not_authorized': 'NA',
                                                 'not_available': 'NA'},
                                  'STATE': {'changed': 'SERVER',
                                            'has_metadata': 'T',
                                            'is_directory': 'F'},
                                  'STATE_OUT': {'changed': 'NA',
                                                'has_metadata': 'F',
                                                'is_directory': 'NA'}},
                                 {'ACTION': 'md.cancel_download(md); md.remove(uuid)',
                                  'ACTION_FUNC': 'file_gone_wile_downloading',
                                  'COMMENTS': 'we are still downloading some content we dont care about anymore',
                                  'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                                 'hash_eq_server_hash': 'NA',
                                                 'not_authorized': 'NA',
                                                 'not_available': 'NA'},
                                  'STATE': {'changed': 'SERVER',
                                            'has_metadata': 'T',
                                            'is_directory': 'T'},
                                  'STATE_OUT': {'changed': 'NA',
                                                'has_metadata': 'F',
                                                'is_directory': 'NA'}}],
            'SV_FILE_NEW': [{'ACTION': 'md.create(path=path, uuid=uuid, type=type)\naq.query(uuid=uuid)',
                              'ACTION_FUNC': 'new_file',
                              'COMMENTS': 'good case, we send a query to see if there are anychanges we need to merge',
                              'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                             'hash_eq_server_hash': 'NA',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NA',
                                        'has_metadata': 'F',
                                        'is_directory': 'NA'},
                              'STATE_OUT': {'changed': 'NONE',
                                            'has_metadata': 'T',
                                            'is_directory': 'F'}},
                             {'ACTION': "Didn't find the node by node_id, but found it by path",
                              'ACTION_FUNC': 'new_server_file_having_local',
                              'COMMENTS': '',
                              'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                             'hash_eq_server_hash': 'NA',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': '*',
                                        'has_metadata': 'T',
                                        'is_directory': '*'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}}],
            'SV_HASH_NEW': [{'ACTION': 'NA',
                              'ACTION_FUNC': '',
                              'COMMENTS': '',
                              'PARAMETERS': {'hash_eq_local_hash': '*',
                                             'hash_eq_server_hash': 'NA',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': '*',
                                        'has_metadata': 'T',
                                        'is_directory': '*'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'NA',
                              'ACTION_FUNC': '',
                              'COMMENTS': '',
                              'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                             'hash_eq_server_hash': '*',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': '*',
                                        'has_metadata': 'T',
                                        'is_directory': '*'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'pass',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': 'server side changes while trying to delete something',
                              'PARAMETERS': {'hash_eq_local_hash': '*',
                                             'hash_eq_server_hash': '*',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NA',
                                        'has_metadata': 'F',
                                        'is_directory': '*'},
                              'STATE_OUT': {'changed': 'NA',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'pass',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': 'no news is good news',
                              'PARAMETERS': {'hash_eq_local_hash': 'T',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'NA',
                              'ACTION_FUNC': '',
                              'COMMENTS': 'NONE, T, F is a falacy (NONE implies server_hash == local_hash)',
                              'PARAMETERS': {'hash_eq_local_hash': 'F',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': '*',
                                            'has_metadata': '*',
                                            'is_directory': '*'}},
                             {'ACTION': 'NA',
                              'ACTION_FUNC': '',
                              'COMMENTS': 'NONE, F, T is a falacy (NONE implies server_hash == local_hash)',
                              'PARAMETERS': {'hash_eq_local_hash': 'T',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': '*',
                                            'has_metadata': '*',
                                            'is_directory': '*'}},
                             {'ACTION': 'md.set(uuid, server_hash=hash)\npartial = md.create_partial(uuid)\naq.getcontent(*partial)',
                              'ACTION_FUNC': 'get_file',
                              'COMMENTS': '',
                              'PARAMETERS': {'hash_eq_local_hash': 'F',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'SERVER',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'NA',
                              'ACTION_FUNC': '',
                              'COMMENTS': 'SERVER, T, T is a impossible (SERVER implies server_hash != local_hash)',
                              'PARAMETERS': {'hash_eq_local_hash': 'T',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': '*',
                                            'has_metadata': '*',
                                            'is_directory': '*'}},
                             {'ACTION': 'pass',
                              'ACTION_FUNC': 'nothing',
                              'COMMENTS': 'A download for a content object with the same hash is already in progress',
                              'PARAMETERS': {'hash_eq_local_hash': 'F',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'md.remove_partial(uuid)\nmd.set(uuid, server_hash=hash)\naq.cancel_download(uuid)',
                              'ACTION_FUNC': 'server_file_changed_back',
                              'COMMENTS': "the local file is equal to the file that is now on the server, but a download is in progress from an older version of the server. Removing the partial ensures that we never complete the download (thus we avoid the dreaded !!! state) Note that this makes it important for AQ_DOWNLOAD_FINISHED to 'pass' on downloads that aren't partials",
                              'PARAMETERS': {'hash_eq_local_hash': 'T',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'NONE',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'aq.cancel_download(uuid)\nmd.set(uuid, server_hash=hash)\npartial = md.get_partial(uuid)\naq.getcontent(*partial)',
                              'ACTION_FUNC': 'reget_file',
                              'COMMENTS': 'a download was in progress but the server changed again. Note that this makes it important for AQ_DOWNLOAD_FINISHED to check the server hash.',
                              'PARAMETERS': {'hash_eq_local_hash': 'F',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'SERVER',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'NA',
                              'ACTION_FUNC': '',
                              'COMMENTS': 'LOCAL, T, T is a impossible (LOCAL implies server_hash != local_hash)',
                              'PARAMETERS': {'hash_eq_local_hash': 'T',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'LOCAL',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': '*',
                                            'has_metadata': '*',
                                            'is_directory': '*'}},
                             {'ACTION': 'aq.upload()',
                              'ACTION_FUNC': 'reput_file_from_local',
                              'COMMENTS': 'The upload was interrupted, just try it again. ',
                              'PARAMETERS': {'hash_eq_local_hash': 'F',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'LOCAL',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'aq.cancel_upload(uuid)\nmd.set(uuid, server_hash=hash)',
                              'ACTION_FUNC': 'server_file_now_matches',
                              'COMMENTS': "there's a small chance that the cancel fails, in which case we're simply redundant",
                              'PARAMETERS': {'hash_eq_local_hash': 'T',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'LOCAL',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'NONE',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'CONFLICT',
                              'ACTION_FUNC': 'local_file_conflict',
                              'COMMENTS': '',
                              'PARAMETERS': {'hash_eq_local_hash': 'F',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'LOCAL',
                                        'has_metadata': 'T',
                                        'is_directory': 'F'},
                              'STATE_OUT': {'changed': 'SERVER',
                                            'has_metadata': 'T',
                                            'is_directory': '='}},
                             {'ACTION': 'pass',
                              'ACTION_FUNC': 'DESPAIR',
                              'COMMENTS': 'cant set hash on directories',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'T'},
                              'STATE_OUT': {'changed': '=',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'md.set(uuid, server_hash=hash)\npartial = md.create_partial(uuid)\naq.getcontent(*partial)',
                              'ACTION_FUNC': 'DESPAIR',
                              'COMMENTS': 'cant set hash on directories',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'NONE',
                                        'has_metadata': 'T',
                                        'is_directory': 'T'},
                              'STATE_OUT': {'changed': 'SERVER',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'aq.cancel_download(uuid) \nmd.set(uuid, server_hash=hash)',
                              'ACTION_FUNC': 'DESPAIR',
                              'COMMENTS': 'cant set hash on directories',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'T',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'T'},
                              'STATE_OUT': {'changed': 'SERVER',
                                            'has_metadata': '=',
                                            'is_directory': '='}},
                             {'ACTION': 'aq.cancel_download(uuid)\nmd.set(uuid, server_hash=hash)\npartial = md.get_partial(uuid)\naq.getcontent(*partial)',
                              'ACTION_FUNC': 'DESPAIR',
                              'COMMENTS': 'cant set hash on directories',
                              'PARAMETERS': {'hash_eq_local_hash': '!NA',
                                             'hash_eq_server_hash': 'F',
                                             'not_authorized': 'NA',
                                             'not_available': 'NA'},
                              'STATE': {'changed': 'SERVER',
                                        'has_metadata': 'T',
                                        'is_directory': 'T'},
                              'STATE_OUT': {'changed': 'NONE',
                                            'has_metadata': '=',
                                            'is_directory': '='}}],
            'SV_MOVED': [{'ACTION': 'DESPAIR',
                           'ACTION_FUNC': 'DESPAIR',
                           'COMMENTS': '',
                           'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                          'hash_eq_server_hash': 'NA',
                                          'not_authorized': 'NA',
                                          'not_available': 'NA'},
                           'STATE': {'changed': 'NA',
                                     'has_metadata': 'F',
                                     'is_directory': 'NA'},
                           'STATE_OUT': {'changed': '*',
                                         'has_metadata': '*',
                                         'is_directory': '*'}},
                          {'ACTION': 'md.move(uuid)',
                           'ACTION_FUNC': 'server_moved',
                           'COMMENTS': 'all pending changes should arrive to the moved file\naq should remove the destination if its there',
                           'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                          'hash_eq_server_hash': 'NA',
                                          'not_authorized': 'NA',
                                          'not_available': 'NA'},
                           'STATE': {'changed': '!SERVER',
                                     'has_metadata': 'T',
                                     'is_directory': '*'},
                           'STATE_OUT': {'changed': '=',
                                         'has_metadata': 'T',
                                         'is_directory': '='}},
                          {'ACTION': 'cancel_download; move; query',
                           'ACTION_FUNC': 'server_moved_dirty',
                           'COMMENTS': 'we got a move while we were downloading it',
                           'PARAMETERS': {'hash_eq_local_hash': 'NA',
                                          'hash_eq_server_hash': 'NA',
                                          'not_authorized': 'NA',
                                          'not_available': 'NA'},
                           'STATE': {'changed': 'SERVER',
                                     'has_metadata': 'T',
                                     'is_directory': '*'},
                           'STATE_OUT': {'changed': '=',
                                         'has_metadata': 'T',
                                         'is_directory': '='}}]},
 'invalid': [{'changed': 'NONE',
              'has_metadata': 'F',
              'is_directory': 'T'},
             {'changed': 'SERVER',
              'has_metadata': 'F',
              'is_directory': 'T'},
             {'changed': 'LOCAL',
              'has_metadata': 'F',
              'is_directory': 'T'},
             {'changed': 'NONE',
              'has_metadata': 'F',
              'is_directory': 'F'},
             {'changed': 'SERVER',
              'has_metadata': 'F',
              'is_directory': 'F'},
             {'changed': 'LOCAL',
              'has_metadata': 'F',
              'is_directory': 'F'},
             {'changed': 'NONE',
              'has_metadata': 'F',
              'is_directory': 'NA'},
             {'changed': 'SERVER',
              'has_metadata': 'F',
              'is_directory': 'NA'},
             {'changed': 'LOCAL',
              'has_metadata': 'F',
              'is_directory': 'NA'},
             {'changed': 'NONE',
              'has_metadata': 'T',
              'is_directory': 'NA'},
             {'changed': 'SERVER',
              'has_metadata': 'T',
              'is_directory': 'NA'},
             {'changed': 'LOCAL',
              'has_metadata': 'T',
              'is_directory': 'NA'},
             {'changed': 'NA',
              'has_metadata': 'T',
              'is_directory': 'NA'},
             {'changed': 'NA',
              'has_metadata': 'T',
              'is_directory': 'F'},
             {'changed': 'NA',
              'has_metadata': 'T',
              'is_directory': 'T'},
             {'changed': 'LOCAL',
              'has_metadata': 'T',
              'is_directory': 'T'},
             {'changed': 'NA',
              'has_metadata': 'F',
              'is_directory': 'T'},
             {'changed': 'NA',
              'has_metadata': 'F',
              'is_directory': 'F'}],
 'parameters': {'hash_eq_local_hash': 'hash == md.local_hash',
                'hash_eq_server_hash': 'hash == md.server_hash',
                'not_authorized': 'error == not authorized',
                'not_available': 'error == not available'},
 'state_vars': {'changed': 'changed',
                'has_metadata': '\u2203 md',
                'is_directory': 'isDirectory'}}
